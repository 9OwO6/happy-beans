# 数据库更新指南

## 问题说明
当前遇到错误：`Could not find the 'image_urls' column of 'products' in the schema cache`

这是因为数据库表结构还没有更新，缺少新的字段。

## 解决方案

### 方法一：更新数据库表结构（推荐）

1. **登录 Supabase 控制台**
   - 访问 https://supabase.com
   - 登录你的账户
   - 选择你的项目

2. **打开 SQL Editor**
   - 在左侧菜单中找到 "SQL Editor"
   - 点击 "New query"

3. **执行更新脚本**
   - 复制 `database_update.sql` 文件中的内容
   - 粘贴到 SQL Editor 中
   - 点击 "Run" 执行

4. **验证更新结果**
   - 执行完成后，查看结果确认更新成功
   - 应该看到类似这样的统计信息：
     ```
     total_products | products_with_image_urls | products_with_category_id | products_with_stock | products_with_tags
     ---------------|-------------------------|---------------------------|-------------------|-------------------
     10             | 10                      | 10                        | 10                | 10
     ```

### 方法二：临时解决方案（已实施）

我已经修改了代码，现在新增产品功能可以正常工作，但只支持单图上传。等数据库更新后，多图功能会自动启用。

## 更新后的功能

数据库更新完成后，你将获得以下新功能：

### 新增字段
- `image_urls`: 存储多张产品图片的数组
- `category_id`: 分类ID，用于精确分类管理
- `stock`: 库存数量
- `tags`: 产品标签数组

### 功能增强
- ✅ 多图上传和展示
- ✅ 分类管理
- ✅ 库存管理
- ✅ 标签系统
- ✅ 更好的搜索和筛选

## 注意事项

1. **备份数据**：执行更新前建议备份现有数据
2. **测试环境**：建议先在测试环境验证
3. **权限检查**：确保有足够的数据库权限

## 如果遇到问题

1. **权限错误**：检查数据库用户权限
2. **字段已存在**：脚本使用了 `IF NOT EXISTS`，不会重复创建
3. **数据丢失**：更新脚本不会删除现有数据

## 联系支持

如果遇到任何问题，请：
1. 检查 Supabase 控制台的错误日志
2. 确认数据库连接正常
3. 验证 SQL 脚本语法正确

---

**更新完成后，重新尝试新增产品，多图上传功能将正常工作！** 